<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>LITV IPTV 直播源生成器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", Arial, sans-serif;
        }
        body {
            background: #f5f5f5;
            padding: 20px;
            max-width: 100%;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        h1 {
            font-size: 20px;
            color: #333;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 600;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: #1677ff;
            color: #fff;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        button:hover {
            opacity: 0.9;
        }
        button.gray {
            background: #666;
        }
        textarea {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 12px;
            line-height: 1.5;
            resize: vertical;
            margin-bottom: 15px;
            background: #fafafa;
        }
        .channel-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .channel-item {
            padding: 10px 15px;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .channel-item:last-child {
            border-bottom: none;
        }
        .channel-item:hover {
            background: #e8f4ff;
        }
        .channel-name {
            font-size: 14px;
            color: #333;
        }
        .channel-id {
            font-size: 12px;
            color: #666;
            font-family: monospace;
        }
        .tip {
            font-size: 12px;
            color: #999;
            text-align: center;
            margin-top: 10px;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>LITV IPTV 直播源生成器</h1>

        <div class="btn-group">
            <button onclick="generateFullM3U()">生成完整 M3U 播放列表</button>
            <button onclick="copyResult()" class="gray">复制结果</button>
            <button onclick="downloadResult()" class="gray">下载文件</button>
        </div>

        <div class="channel-list" id="channelList">
            <!-- 频道列表由JS生成 -->
        </div>

        <textarea id="resultArea" placeholder="生成的播放源内容会显示在这里..."></textarea>

        <div class="tip">
            1. 点击频道可生成单个频道的 M3U8 地址<br>
            2. 生成的 M3U 可直接导入 IPTV 播放器<br>
            3. 无需后端服务器，纯前端运行
        </div>
    </div>

    <script>
        // 频道配置（和原PHP脚本一致）
        const CHANNELS = {
            "4gtv-4gtv002":[1,11,"民視"],
            "4gtv-4gtv003":[1,7,"民視第一台"],
            "litv-ftv13":[1,7,"民視新聞台"],
            "4gtv-4gtv001":[1,7,"民視台灣台"],
            "litv-ftv09":[1,6,"民視影劇台"],
            "litv-ftv07":[1,6,"民視旅遊台"],
            "4gtv-4gtv004":[1,9,"民視綜藝台"],
            "4gtv-4gtv040":[1,7,"中視"],
            "4gtv-4gtv074":[1,6,"中視新聞台"],
            "4gtv-4gtv009":[2,9,"中天新聞台"],
            "4gtv-4gtv041":[1,7,"華視"],
            "4gtv-4gtv052":[1,6,"華視新聞"],
            "4gtv-4gtv046":[1,7,"靖天綜合台"],
            "4gtv-4gtv063":[1,8,"靖天國際台"],
            "4gtv-4gtv058":[1,9,"靖天戲劇台"],
            "4gtv-4gtv062":[1,9,"靖天育樂台"],
            "4gtv-4gtv065":[1,9,"靖天資訊台"],
            "4gtv-4gtv061":[1,7,"靖天電影台"],
            "4gtv-4gtv054":[1,9,"靖天歡樂台"],
            "litv-longturn12":[5,2,"龍華偶像台"],
            "litv-longturn01":[4,5,"龍華卡通台"],
            "litv-longturn18":[5,6,"龍華戲劇台"],
            "litv-longturn11":[5,2,"龍華日韓台"],
            "litv-longturn21":[5,6,"龍華經典台"],
            "litv-longturn03":[5,6,"龍華電影台"],
            "litv-longturn02":[5,2,"龍華洋片台"],
            "4gtv-4gtv045":[1,7,"靖洋戲劇台"],
            "4gtv-4gtv057":[1,7,"靖洋卡通NiceBingo"],
            "litv-longturn14":[1,6,"寰宇新聞台"],
            "4gtv-4gtv156":[1,8,"寰宇新聞台灣台"],
            "4gtv-4gtv158":[1,2,"寰宇財經台"],
            "4gtv-4gtv073":[1,6,"TVBS"],
            "4gtv-4gtv072":[1,6,"TVBS新聞台"],
            "4gtv-4gtv068":[1,8,"TVBS歡樂台"],
            "4gtv-4gtv067":[1,9,"TVBS精采台"],
            "4gtv-4gtv034":[1,7,"八大精彩台"],
            "4gtv-4gtv039":[1,6,"八大綜藝台"],
            "4gtv-4gtv070":[1,9,"ELTA娛樂台"],
            "litv-longturn20":[5,7,"ELTV生活英語"],
            "4gtv-4gtv152":[1,7,"東森新聞"],
            "4gtv-4gtv153":[1,6,"東森財經新聞"],
            "4gtv-4gtv075":[1,6,"鏡電視新聞台"],
            "4gtv-4gtv076":[1,7,"亞洲旅遊台"],
            "4gtv-4gtv053":[1,9,"GINXEsportsTV"],
            "4gtv-4gtv014":[1,6,"時尚運動X"],
            "4gtv-4gtv101":[1,6,"智林體育台"],
            "4gtv-4gtv077":[1,5,"TraceSports"],
            "4gtv-4gtv011":[1,7,"影迷數位電影台"],
            "4gtv-4gtv017":[1,7,"AMC電影台"],
            "4gtv-4gtv042":[1,7,"公視戲劇台"],
            "4gtv-4gtv049":[1,9,"采昌影劇台"],
            "litv-longturn22":[5,2,"台灣戲劇台"],
            "litv-ftv15":[1,7,"影迷數位紀實台"],
            "4gtv-4gtv018":[1,7,"達文西頻道"],
            "4gtv-4gtv059":[1,7,"Classica古典樂"],
            "4gtv-4gtv083":[1,6,"MezzoLive"],
            "4gtv-4gtv006":[1,10,"豬哥亮歌廳秀"],
            "4gtv-4gtv082":[1,7,"TraceUrban"],
            "4gtv-4gtv016":[1,7,"韓國娛樂台"],
            "4gtv-4gtv079":[1,8,"ArirangTV"],
            "litv-ftv10":[1,7,"MCE 我的歐洲電影"],
            "4gtv-4gtv104":[1,7,"第1商業台"],
            "4gtv-4gtv110":[1,6,"Pet Club TV"],
            "litv-longturn19":[5,7,"Smart知識台"],
            "4gtv-4gtv013":[1,7,"視納華仁紀實頻道"],
            "4gtv-4gtv043":[1,7,"客家電視台"],
            "litv-ftv16":[1,6,"好消息"],
            "litv-ftv17":[1,6,"好消息2台"],
            "4gtv-4gtv084":[1,7,"國會頻道1"],
            "4gtv-4gtv085":[1,6,"國會頻道2"],
            "4gtv-4gtv155":[1,7,"民視"],
            "4gtv-4gtv080":[1,8,"中視經典台"],
            "4gtv-4gtv064":[1,9,"中視菁采台"],
            "4gtv-4gtv109":[1,9,"中天亞洲台"],
            "4gtv-4gtv066":[1,6,"台視"],
            "4gtv-4gtv051":[1,6,"台視新聞台"],
            "4gtv-4gtv056":[1,6,"台視財經台"],
            "litv-longturn07":[5,2,"博斯運動一台"],
            "litv-longturn08":[5,2,"博斯運動二台"],
            "litv-longturn10":[5,2,"博斯無限台"],
            "litv-longturn13":[4,6,"博斯無限二台"],
            "litv-longturn09":[5,2,"博斯網球台"],
            "litv-longturn05":[5,2,"博斯高球台"],
            "litv-longturn06":[5,2,"博斯高球二台"],
            "litv-longturn04":[5,7,"博斯魅力台"],
            "4gtv-4gtv010":[1,7,"非凡新聞台"],
            "4gtv-4gtv048":[1,7,"非凡商業台"],
            "litv-ftv03":[1,7,"VOA美國之音"]
        };

        // 页面加载时生成频道列表
        window.onload = function() {
            renderChannelList();
        };

        // 渲染频道列表
        function renderChannelList() {
            const listEl = document.getElementById('channelList');
            let html = '';
            for (const [id, [qlt, alt, name]] of Object.entries(CHANNELS)) {
                html += `
                <div class="channel-item" onclick="generateSingleChannel('${id}')">
                    <span class="channel-name">${name}</span>
                    <span class="channel-id">${id}</span>
                </div>
                `;
            }
            listEl.innerHTML = html;
        }

        // 获取当前页面URL（用于生成播放列表中的链接）
        function getCurrentUrl() {
            return window.location.href.split('?')[0];
        }

        // 生成完整M3U播放列表
        function generateFullM3U() {
            const baseUrl = getCurrentUrl();
            let m3u = "#EXTM3U\n";
            for (const [id, [qlt, alt, name]] of Object.entries(CHANNELS)) {
                m3u += `#EXTINF:-1 tvg-id="${id}" tvg-name="${name}" group-title="LITV系列",${name}\n`;
                m3u += `${baseUrl}?id=${id}\n`;
            }
            document.getElementById('resultArea').value = m3u;
        }

        // 生成单个频道的M3U8地址
        function generateSingleChannel(id) {
            const [qlt, alt, name] = CHANNELS[id];
            const timestamp = Math.floor(Date.now() / 1000 / 4 - 355017628);
            const t = timestamp * 4;
            let m3u8 = "#EXTM3U\n";
            m3u8 += "#EXT-X-VERSION:3\n";
            m3u8 += "#EXT-X-TARGETDURATION:4\n";
            m3u8 += `#EXT-X-MEDIA-SEQUENCE:${timestamp}\n`;
            
            let currentTs = timestamp;
            let currentT = t;
            for (let i = 0; i < 10; i++) {
                m3u8 += "#EXTINF:4,\n";
                m3u8 += `https://ntd-tgc.cdn.hinet.net/live/pool/${id}/litv-pc/${id}-avc1_6000000=${qlt}-mp4a_134000_zho=${alt}-begin=${currentT}0000000-dur=40000000-seq=${currentTs}.ts\n`;
                currentTs++;
                currentT += 4;
            }
            document.getElementById('resultArea').value = m3u8;
            alert(`已生成【${name}】的 M3U8 播放流`);
        }

        // 复制结果
        function copyResult() {
            const textarea = document.getElementById('resultArea');
            if (!textarea.value) {
                alert('暂无内容可复制！');
                return;
            }
            textarea.select();
            document.execCommand('copy');
            alert('复制成功！');
        }

        // 下载结果
        function downloadResult() {
            const textarea = document.getElementById('resultArea');
            if (!textarea.value) {
                alert('暂无内容可下载！');
                return;
            }
            const isM3U8 = textarea.value.includes('#EXT-X-MEDIA-SEQUENCE');
            const fileName = isM3U8 ? 'channel.m3u8' : 'litv_iptv.m3u';
            const blob = new Blob([textarea.value], { type: 'application/octet-stream' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
            alert(`已下载 ${fileName}`);
        }
    </script>
</body>
</html>
